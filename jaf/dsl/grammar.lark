%import common.WS
%import common.ESCAPED_STRING
%import common.SIGNED_NUMBER
%ignore WS

start: expr

expr: bool_expr

?bool_expr: or_expr

?or_expr: and_expr
        | or_expr OR and_expr -> or_operation

?and_expr: primary
        | and_expr AND primary -> and_operation

?primary: operand
       | "(" bool_expr ")"

?operand: condition
       | function_call
       | path
       | value

condition: operand operator operand

operator: IDENTIFIER

function_call: "(" IDENTIFIER operand+ ")"

path: ":" path_component ("." path_component)*

path_component: IDENTIFIER 
             | STAR  
             | DOUBLESTAR
             | NUMBER

STAR: "*" 
DOUBLESTAR: "**"

value: ESCAPED_STRING
     | NUMBER
     | BOOLEAN
     | "null"

BOOLEAN: "true" | "false"
NUMBER: SIGNED_NUMBER

IDENTIFIER: /(?!true|false|null)[a-zA-Z][a-zA-Z0-9_\-\?]*/

OR: "OR"
AND: "AND"