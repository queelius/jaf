
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://queelius.github.io/jaf/specification/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../cli_reference/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Specification - JAF - JSON Array Filter</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#jaf-json-array-filter---specification-v11" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="JAF - JSON Array Filter" class="md-header__button md-logo" aria-label="JAF - JSON Array Filter" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            JAF - JSON Array Filter
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Specification
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/queelius/jaf" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    queelius/jaf
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  Specification

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../cli_reference/" class="md-tabs__link">
        
  
  
    
  
  CLI Reference

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="JAF - JSON Array Filter" class="md-nav__button md-logo" aria-label="JAF - JSON Array Filter" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    JAF - JSON Array Filter
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/queelius/jaf" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    queelius/jaf
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Specification
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Specification
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-philosophy" class="md-nav__link">
    <span class="md-ellipsis">
      Core Philosophy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-model" class="md-nav__link">
    <span class="md-ellipsis">
      Data Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jafresultset-object" class="md-nav__link">
    <span class="md-ellipsis">
      JafResultSet Object
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-format" class="md-nav__link">
    <span class="md-ellipsis">
      Query Format
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#path-system" class="md-nav__link">
    <span class="md-ellipsis">
      Path System
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operator-categories" class="md-nav__link">
    <span class="md-ellipsis">
      Operator Categories
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operator Categories">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-special-forms-custom-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      1. Special Forms (Custom Evaluation)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-predicates-return-boolean" class="md-nav__link">
    <span class="md-ellipsis">
      2. Predicates (Return Boolean)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-value-extractors-support-predicates" class="md-nav__link">
    <span class="md-ellipsis">
      3. Value Extractors (Support Predicates)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#function-signatures" class="md-nav__link">
    <span class="md-ellipsis">
      Function Signatures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evaluation-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Evaluation Rules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Evaluation Rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-literals" class="md-nav__link">
    <span class="md-ellipsis">
      1. Literals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-special-forms" class="md-nav__link">
    <span class="md-ellipsis">
      2. Special Forms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-regular-functions-predicates-and-value-extractors" class="md-nav__link">
    <span class="md-ellipsis">
      3. Regular Functions (Predicates and Value Extractors)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-pathvalues-in-predicates-and-functions-interaction-with-adapt_jaf_operator" class="md-nav__link">
    <span class="md-ellipsis">
      4. PathValues in Predicates and Functions (Interaction with adapt_jaf_operator)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boolean-algebra-on-result-sets" class="md-nav__link">
    <span class="md-ellipsis">
      Boolean Algebra on Result Sets
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resolving-result-sets-to-original-data" class="md-nav__link">
    <span class="md-ellipsis">
      Resolving Result Sets to Original Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Handling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#path-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Path Errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Type Errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jafresultset-errors" class="md-nav__link">
    <span class="md-ellipsis">
      JafResultSet Errors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Example Queries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Example Queries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-filtering" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Filtering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complex-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Complex Conditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#path-system-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Path System Examples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#design-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      Design Constraints
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI Reference
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<!-- Copied from SPECIFICATION.md -->
<h1 id="jaf-json-array-filter---specification-v11">JAF (JSON Array Filter) - Specification v1.1<a class="headerlink" href="#jaf-json-array-filter---specification-v11" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>JAF is a simple, focused domain-specific language for filtering JSON arrays. It's designed to be <strong>not Turing-complete</strong> and focuses solely on filtering with predictable boolean results. It also supports boolean algebraic operations on sets of filter results.</p>
<h2 id="core-philosophy">Core Philosophy<a class="headerlink" href="#core-philosophy" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Simple</strong>: Easy to understand and debug</li>
<li><strong>Predictable</strong>: Every query returns boolean results for filtering</li>
<li><strong>Secure</strong>: No arbitrary code execution or side effects</li>
<li><strong>Focused</strong>: Designed specifically for JSON array filtering and result set manipulation</li>
</ul>
<h2 id="data-model">Data Model<a class="headerlink" href="#data-model" title="Permanent link">&para;</a></h2>
<p><strong>Input to <code>jaf</code> function</strong>: <code>Array&lt;Object&gt;</code> - An array of JSON objects.
<strong>Output of <code>jaf</code> function</strong>: <code>JafResultSet</code> - An object representing the filter results.</p>
<h2 id="jafresultset-object"><code>JafResultSet</code> Object<a class="headerlink" href="#jafresultset-object" title="Permanent link">&para;</a></h2>
<p>A <code>JafResultSet</code> represents the set of indices from a data collection that satisfy a JAF query, along with metadata to ensure logical consistency when combining results or resolving them back to original data.</p>
<p><strong>Attributes / JSON Structure:</strong></p>
<p>When serialized to JSON (e.g., by the CLI), a <code>JafResultSet</code> has the following structure:</p>
<ul>
<li><code>indices</code>: <code>Array&lt;Number&gt;</code> (integer)<ul>
<li>A sorted list of unique, 0-based indices of the objects from the original data array that matched the query.</li>
</ul>
</li>
<li><code>collection_size</code>: <code>Number</code> (integer)<ul>
<li>The total number of items in the original data collection from which the indices were derived. This is crucial for operations like <code>NOT</code>.</li>
</ul>
</li>
<li><code>collection_id</code>: <code>Any</code> (string, number, null, etc.)<ul>
<li>An optional identifier for the original data collection. This helps ensure that boolean operations are performed between result sets derived from the same logical collection. It can be a file path, directory path, or a user-defined ID.</li>
</ul>
</li>
<li><code>filenames_in_collection</code>: <code>Array&lt;String&gt;</code> (optional)<ul>
<li>A sorted list of unique, absolute file paths that contributed data to form the collection. This is primarily populated when the input to <code>jaf filter</code> is a directory. It's used by <code>jaf resolve</code> (and <code>JafResultSet.get_matching_objects()</code>) to locate the original data.</li>
</ul>
</li>
</ul>
<p><strong>Example JSON Output (compact):</strong>
<div class="language-json highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">{</span><span class="nt">&quot;indices&quot;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="nt">&quot;collection_size&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="nt">&quot;collection_id&quot;</span><span class="p">:</span><span class="s2">&quot;/path/to/data.json&quot;</span><span class="p">,</span><span class="nt">&quot;filenames_in_collection&quot;</span><span class="p">:[</span><span class="s2">&quot;/path/to/data.json&quot;</span><span class="p">]}</span>
</span></code></pre></div>
If <code>filenames_in_collection</code> is not present or <code>null</code>, it's omitted from the JSON.</p>
<h2 id="query-format">Query Format<a class="headerlink" href="#query-format" title="Permanent link">&para;</a></h2>
<p>Queries use S-expression syntax: <code>[operator, arg1, arg2, ...]</code></p>
<p><strong>Examples</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">[</span><span class="s2">&quot;eq?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]]],</span> <span class="s2">&quot;John&quot;</span><span class="p">]</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="p">[</span><span class="s2">&quot;and&quot;</span><span class="p">,</span> 
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>  <span class="p">[</span><span class="s2">&quot;exists?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">]]]],</span> 
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>  <span class="p">[</span><span class="s2">&quot;gt?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">]]]],</span> <span class="mi">5</span><span class="p">]</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="p">]</span>
</span></code></pre></div>
<h2 id="path-system">Path System<a class="headerlink" href="#path-system" title="Permanent link">&para;</a></h2>
<p>The JAF Path System is a small, dedicated sub-language for data traversal within JSON objects. Paths are <strong>lists of tagged components</strong> used within the <code>["path", path_components_list]</code> special form. This tagged structure (its own AST) provides a uniform and explicit way to define how to traverse the JSON data.</p>
<p>Each component in the <code>path_components_list</code> is a list itself, where the first element is a tag (string) indicating the type of path segment, and subsequent elements are arguments for that segment type.</p>
<p><strong>Supported Path Component Tags:</strong></p>
<ol>
<li>
<p><code>["key", &lt;string_key_name&gt;]</code></p>
<ul>
<li>Accesses an object's property by its string key.</li>
<li>Example: <code>[["key", "user"]]</code> accesses <code>obj["user"]</code>.</li>
</ul>
</li>
<li>
<p><code>["index", &lt;integer_index_value&gt;]</code></p>
<ul>
<li>Accesses an array element by its integer index (supports negative indexing).</li>
<li>Example: <code>[["key", "items"], ["index", 0]]</code> accesses <code>obj["items"][0]</code>.</li>
</ul>
</li>
<li>
<p><code>["indices", [&lt;int_idx1&gt;, &lt;int_idx2&gt;, ...]]</code></p>
<ul>
<li>Accesses multiple array elements by a list of specific integer indices.</li>
<li>Returns a list of values found at these indices.</li>
<li>Example: <code>[["key", "tags"], ["indices", [0, 2, 4]]]</code> accesses <code>obj["tags"][0]</code>, <code>obj["tags"][2]</code>, and <code>obj["tags"][4]</code>.</li>
</ul>
</li>
<li>
<p><code>["slice", &lt;start_val_or_null&gt; [, &lt;stop_val_or_null&gt; [, &lt;step_val_or_null&gt;]]]</code></p>
<ul>
<li>Accesses a slice of an array. The AST component will have 1, 2, or 3 values after the "slice" tag, corresponding to <code>start</code>, <code>stop</code>, and <code>step</code>.</li>
<li><code>start_val_or_null</code>: The starting index. If <code>null</code> or omitted, defaults to the beginning of the array.</li>
<li><code>stop_val_or_null</code>: The ending index (exclusive). If <code>null</code> or omitted, defaults to the end of the array.</li>
<li><code>step_val_or_null</code>: The step value. If <code>null</code> or omitted, defaults to <code>1</code>. A step of <code>0</code> is invalid.</li>
<li>Example ASTs:<ul>
<li><code>[["slice", 0, 10, 2]]</code> (explicit start, stop, step)</li>
<li><code>[["slice", null, 5]]</code> (start from beginning, up to 5, step 1) -&gt; equivalent to <code>[["slice", null, 5, null]]</code> for evaluation</li>
<li><code>[["slice", 2]]</code> (start from 2, to end, step 1) -&gt; equivalent to <code>[["slice", 2, null, null]]</code> for evaluation</li>
</ul>
</li>
<li>Example from query: <code>[["key", "data"], ["slice", 0, 10, 2]]</code> accesses elements from index 0 up to (but not including) 10, with a step of 2.</li>
<li><code>[["key", "data"], ["slice", null, 5]]</code> accesses elements from the beginning up to index 5 with a default step of 1.</li>
</ul>
</li>
<li>
<p><code>["regex_key", &lt;pattern_string&gt;]</code></p>
<ul>
<li>Accesses object properties where keys match the given regular expression pattern.</li>
<li>Returns a list of values from matching keys.</li>
<li>Example: <code>[["regex_key", "^error_\\d+$"]]</code> accesses values for keys like "error_1", "error_2", etc. (Note: <code>\</code> in regex might need escaping depending on the string representation in the query).</li>
</ul>
</li>
<li>
<p><code>["wc_level"]</code> (Wildcard - Current Level)</p>
<ul>
<li>Matches any single field name or array index at the current level of the object or array.</li>
<li><strong>Motivation</strong>: Useful for iterating over elements of a list or values of a dictionary when the keys/indices are not known beforehand, or when an operation needs to be applied to all direct children.</li>
<li>Example: <code>[["key", "tasks"], ["wc_level"], ["key", "status"]]</code> accesses the "status" of each task in the "tasks" list.</li>
</ul>
</li>
<li>
<p><code>["wc_recursive"]</code> (Wildcard - Recursive Descent)</p>
<ul>
<li>Matches any field name recursively at any depth within the current object structure. It also considers the current level for matches if the subsequent path parts align.</li>
<li><strong>Motivation</strong>: Essential for deep searches where the target data might be nested at varying or unknown depths.</li>
<li>Example: <code>[["wc_recursive"], ["key", "error_code"]]</code> finds any "error_code" field anywhere in the object.</li>
</ul>
</li>
<li><code>["root"]</code><ul>
<li>Represents the root of the object against which the entire path expression is being evaluated.</li>
<li>Allows paths to "restart" or reference from the top-level object, even if the current evaluation context is nested due to prior path components.</li>
<li>Example: <code>[["key", "user"], ["root"], ["key", "config"]]</code> - if <code>obj</code> is <code>{"user": {"name": "A"}, "config": {"setting": "X"}}</code>, this path would first go to <code>obj["user"]</code>, then <code>["root"]</code> would reset the context to <code>obj</code>, and <code>["key", "config"]</code> would access <code>obj["config"]</code>.</li>
</ul>
</li>
</ol>
<p><strong>Path Evaluation (<code>eval_path</code> function):</strong></p>
<p>The <code>eval_path(obj, path_components_list)</code> function (internally used by the <code>["path", ...]</code> special form) evaluates the given path against the <code>obj</code>.</p>
<ul>
<li><strong>Return Value</strong>:<ul>
<li>If the path does not contain multi-match components (i.e., only uses <code>["key", ...]</code> or <code>["index", ...]</code>) and successfully resolves to a single, definite value, that value is returned directly. This includes <code>None</code> if the field exists and its value is <code>null</code>.</li>
<li>If the path involves components that can naturally yield multiple values (e.g., <code>["indices", ...]</code>, <code>["slice", ...]</code>, <code>["regex_key", ...]</code>, <code>["wc_level"]</code>, <code>["wc_recursive"]</code>), <code>eval_path</code> returns a <code>PathValues</code> object. <code>PathValues</code> is a specialized list subclass that holds the collection of all values found by the path. It preserves the order of discovery and can contain duplicates if the data and path logic lead to them. It offers convenience methods for accessing its contents (e.g., <code>first()</code>, <code>one()</code>).</li>
<li>If a path that does <em>not</em> contain multi-match components fails to resolve at any point (e.g., a key not found, an index out of bounds for a specific index access), <code>eval_path</code> returns an empty list <code>[]</code>. This signifies "not found" or "no value" for a specific path.</li>
<li>If a path <em>with</em> multi-match components finds no values, it returns an empty <code>PathValues</code> object (e.g., <code>PathValues([])</code>). This is distinct from the <code>[]</code> returned for a specific path not found.</li>
<li>If the <code>path_components_list</code> is empty (e.g., <code>["path", []]</code>), <code>eval_path</code> returns the original <code>obj</code>.</li>
<li>In rare cases where a path <em>without</em> multi-match components unexpectedly yields multiple distinct results, <code>eval_path</code> may also wrap these results in a <code>PathValues</code> object with a warning.</li>
</ul>
</li>
</ul>
<p><strong>Examples of Path Syntax:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Access a top-level key:</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]]]</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># Access a nested key:</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">]]]</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="c1"># Access all &quot;status&quot; fields from items in a list:</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;wc_level&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">]]]</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="c1"># Access an element by index:</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">]]]</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="c1"># Access elements via slice:</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;measurements&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;slice&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">null</span><span class="p">]]]</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="c1"># Access elements via specific indices:</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;users&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;indices&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]]]</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="c1"># Access elements via regex on keys:</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;logs&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;regex_key&quot;</span><span class="p">,</span> <span class="s2">&quot;session_</span><span class="se">\\</span><span class="s2">w+&quot;</span><span class="p">]]]</span>
</span></code></pre></div>
<p><strong>Behavior of the <code>["path", ...]</code> special form:</strong></p>
<ul>
<li>When the <code>["path", ...]</code> form is evaluated, it internally calls <code>eval_path</code> with the current object and the provided <code>path_components_list</code>.</li>
<li>The result of <code>eval_path</code> (a single value, <code>None</code>, <code>[]</code>, or a <code>PathValues</code> list) is then used as the value of the <code>["path", ...]</code> expression in the broader JAF query.</li>
</ul>
<h2 id="operator-categories">Operator Categories<a class="headerlink" href="#operator-categories" title="Permanent link">&para;</a></h2>
<h3 id="1-special-forms-custom-evaluation">1. Special Forms (Custom Evaluation)<a class="headerlink" href="#1-special-forms-custom-evaluation" title="Permanent link">&para;</a></h3>
<ul>
<li><code>path</code> - Extract values: <code>["path", [["key", "field"], ["key", "subfield"]]]</code></li>
<li><code>exists?</code> - Check existence: <code>["exists?", ["path", [["key", "field"]]]]</code></li>
<li><code>exists?</code> returns <code>true</code> if <code>eval_path</code> for the given path components returns anything other than an empty list <code>[]</code> (when the path is specific and not found) or an empty <code>PathValues</code> (when the path is multi-match and not found). A path to a <code>null</code> value <em>does</em> exist and <code>exists?</code> will return <code>true</code>.</li>
<li><code>if</code> - Conditional: <code>["if", condition, true-expr, false-expr]</code></li>
<li><code>and</code> - Logical AND with short-circuit: <code>["and", expr1, expr2, ...]</code></li>
<li><code>or</code> - Logical OR with short-circuit: <code>["or", expr1, expr2, ...]</code></li>
<li><code>not</code> - Logical negation: <code>["not", expr]</code></li>
</ul>
<h3 id="2-predicates-return-boolean">2. Predicates (Return Boolean)<a class="headerlink" href="#2-predicates-return-boolean" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Comparison</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="s2">&quot;eq?&quot;</span><span class="p">,</span> <span class="s2">&quot;neq?&quot;</span><span class="p">,</span> <span class="s2">&quot;gt?&quot;</span><span class="p">,</span> <span class="s2">&quot;gte?&quot;</span><span class="p">,</span> <span class="s2">&quot;lt?&quot;</span><span class="p">,</span> <span class="s2">&quot;lte?&quot;</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1"># Containment  </span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="s2">&quot;in?&quot;</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="c1"># String matching</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="s2">&quot;starts-with?&quot;</span><span class="p">,</span> <span class="s2">&quot;ends-with?&quot;</span><span class="p">,</span> <span class="s2">&quot;regex-match?&quot;</span><span class="p">,</span> <span class="s2">&quot;close-match?&quot;</span><span class="p">,</span> <span class="s2">&quot;partial-match?&quot;</span>
</span></code></pre></div>
<h3 id="3-value-extractors-support-predicates">3. Value Extractors (Support Predicates)<a class="headerlink" href="#3-value-extractors-support-predicates" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1"># Data access</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;keys&quot;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="c1"># String transformation  </span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="s2">&quot;lower-case&quot;</span><span class="p">,</span> <span class="s2">&quot;upper-case&quot;</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="c1"># Date/time</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="s2">&quot;now&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="s2">&quot;date-diff&quot;</span><span class="p">,</span> <span class="s2">&quot;days&quot;</span><span class="p">,</span> <span class="s2">&quot;seconds&quot;</span>
</span></code></pre></div>
<h2 id="function-signatures">Function Signatures<a class="headerlink" href="#function-signatures" title="Permanent link">&para;</a></h2>
<p>All functions follow this pattern:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="p">[</span><span class="n">function</span><span class="o">-</span><span class="n">name</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>
</span></code></pre></div>
<p><strong>Examples</strong>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="p">[</span><span class="s2">&quot;eq?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]]],</span> <span class="s2">&quot;John&quot;</span><span class="p">]</span>                    <span class="c1"># name == &quot;John&quot;</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="p">[</span><span class="s2">&quot;gt?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">]]]],</span> <span class="mi">5</span><span class="p">]</span>            <span class="c1"># len(items) &gt; 5  </span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="p">[</span><span class="s2">&quot;starts-with?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;lower-case&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">]]]],</span> <span class="s2">&quot;admin&quot;</span><span class="p">]</span>  <span class="c1"># email.lower().startswith(&quot;admin&quot;)</span>
</span></code></pre></div>
<h2 id="evaluation-rules">Evaluation Rules<a class="headerlink" href="#evaluation-rules" title="Permanent link">&para;</a></h2>
<h3 id="1-literals">1. Literals<a class="headerlink" href="#1-literals" title="Permanent link">&para;</a></h3>
<ul>
<li>Strings, numbers, booleans, null are returned as-is.</li>
<li><code>"hello"</code> → <code>"hello"</code></li>
<li><code>42</code> → <code>42</code></li>
<li><code>null</code> → <code>None</code> (in Python representation)</li>
</ul>
<h3 id="2-special-forms">2. Special Forms<a class="headerlink" href="#2-special-forms" title="Permanent link">&para;</a></h3>
<ul>
<li>Evaluated with custom logic (don't evaluate all args first).</li>
<li>Handle control flow and path access.</li>
</ul>
<h3 id="3-regular-functions-predicates-and-value-extractors">3. Regular Functions (Predicates and Value Extractors)<a class="headerlink" href="#3-regular-functions-predicates-and-value-extractors" title="Permanent link">&para;</a></h3>
<ul>
<li>All arguments evaluated first, then function called.</li>
<li>Predictable evaluation order.</li>
</ul>
<h3 id="4-pathvalues-in-predicates-and-functions-interaction-with-adapt_jaf_operator">4. <code>PathValues</code> in Predicates and Functions (Interaction with <code>adapt_jaf_operator</code>)<a class="headerlink" href="#4-pathvalues-in-predicates-and-functions-interaction-with-adapt_jaf_operator" title="Permanent link">&para;</a></h3>
<p>When a <code>PathValues</code> object (the result of a <code>["path", ...]</code> expression involving components like <code>wc_level</code>, <code>wc_recursive</code>, <code>indices</code>, <code>slice</code>, or <code>regex_key</code>) is used as an argument to a predicate or a value-transforming function, JAF (via the <code>adapt_jaf_operator</code> utility) employs a specific evaluation strategy. <code>PathValues</code> represents the collection of all values found by such a path.</p>
<p><strong>a. Argument Expansion (Cartesian Product):</strong></p>
<ul>
<li>If one or more arguments to a function are <code>PathValues</code> lists, the system generates all possible combinations of individual values from these lists. This is equivalent to a Cartesian product.</li>
<li>Arguments that are not <code>PathValues</code> lists (i.e., single values) are treated as single-element lists for this product generation.</li>
<li>The underlying function (predicate or transformer) is then invoked for each unique combination of arguments derived from this expansion.</li>
</ul>
<p><strong>b. Predicate Evaluation (Existential Quantification - ∃):</strong></p>
<ul>
<li>If the function being called is a <strong>predicate</strong> (typically its name ends with <code>?</code>):</li>
<li>The predicate evaluates to <code>true</code> if <strong>there exists at least one combination</strong> of expanded arguments for which the predicate's condition holds.</li>
<li>If all combinations evaluate to <code>false</code>, or if any <code>PathValues</code> argument was initially empty (resulting in no combinations to test), the overall predicate evaluates to <code>false</code>.</li>
<li><strong>Example</strong>: <code>["eq?", ["path", [["key", "items"], ["wc_level"], ["key", "status"]]], "completed"]</code>.
    Let <code>S = eval_path(obj, [["key", "items"], ["wc_level"], ["key", "status"]]])</code>. The predicate is true if ∃ <em>s</em> ∈ <code>S</code> such that <code>eq?(s, "completed")</code> is true.</li>
<li>Type errors or attribute errors encountered during the evaluation of a specific combination for a predicate cause that particular combination to yield <code>false</code>. The overall predicate can still be <code>true</code> if another combination succeeds.</li>
</ul>
<p><strong>c. Value Extractor/Transformer Evaluation:</strong></p>
<ul>
<li>If the function is a <strong>value extractor or transformer</strong>:</li>
<li>The function is called for each combination of arguments generated as per (4a).</li>
<li>A list containing the results from all these individual function calls is collected.</li>
<li><strong>Result Aggregation</strong>:<ul>
<li>If this list of results contains exactly one item, that single item is returned.</li>
<li>If this list contains one item which is itself a list (e.g., <code>[[1,2,3]]</code> where the inner list was the actual return value of the function for the single combination), this inner list is "unwrapped" and returned (e.g., <code>[1,2,3]</code>). This rule does not apply if the single item is already a <code>PathValues</code> instance or if the outer list is a <code>PathValues</code> instance.</li>
<li>Otherwise (multiple results from multiple combinations, or an empty list if no combinations were processed due to an empty <code>PathValues</code>), the collected list of results is returned (often as a <code>PathValues</code> object if multiple results arose from expansion).</li>
<li>If any <code>PathValues</code> argument was empty, leading to no combinations, an empty list <code>[]</code> is typically returned by the wrapper for the value extractor.</li>
</ul>
</li>
</ul>
<p><strong>d. Universal Quantification (<code>∀</code>) and <code>path</code>:</strong></p>
<ul>
<li>The <code>path</code> operator itself is designed for <em>data extraction</em> – it gathers all values that match a given path. It does not inherently perform universal quantification ("for all").</li>
<li>Universal quantification is a <em>checking</em> operation. While not directly supported by <code>path</code>, such checks can often be constructed using negation and existential quantification (e.g., "it is NOT true that there EXISTS an item that does NOT satisfy the condition"). For example, to check if all items in a list have <code>status == "active"</code>: <code>["not", ["in?", false, ["map", ["lambda", "x", ["eq?", ["path", [["key", "x"], ["key", "status"]]], "active"]], ["path", [["key", "items"]]]]]]</code> (assuming a hypothetical <code>map</code> and <code>lambda</code> for illustration; JAF does not have these directly but similar logic can be built with <code>and</code>/<code>or</code> over known items or by checking for the non-existence of a counter-example). A simpler approach for "all items satisfy X" is often "NOT (EXISTS item that does NOT satisfy X)".</li>
</ul>
<h2 id="boolean-algebra-on-result-sets">Boolean Algebra on Result Sets<a class="headerlink" href="#boolean-algebra-on-result-sets" title="Permanent link">&para;</a></h2>
<p>The <code>JafResultSet</code> class provides methods for performing boolean algebra. This allows combining results from multiple <code>jaf</code> filter operations.</p>
<p><strong>Motivation:</strong>
-   <strong>Modularity</strong>: Build complex filters from simpler, pre-computed results.
-   <strong>Clarity</strong>: Easier to express and understand intricate logic.
-   <strong>Reusability</strong>: Saved result sets can be reused.
-   <strong>Formal Semantics</strong>: Leverages well-understood set theory.</p>
<p><strong>Core Methods (Python <code>JafResultSet</code> class):</strong></p>
<p>Each method returns a <em>new</em> <code>JafResultSet</code> instance.</p>
<ol>
<li>
<p><code>AND(self, other: 'JafResultSet') -&gt; 'JafResultSet'</code> (or <code>self &amp; other</code>)</p>
<ul>
<li>Performs a set intersection of <code>self.indices</code> and <code>other.indices</code>.</li>
<li>Requires compatibility (see below).</li>
<li>The resulting <code>collection_id</code> is <code>self.collection_id</code> if not None, else <code>other.collection_id</code>.</li>
<li>The resulting <code>filenames_in_collection</code> is <code>self.filenames_in_collection</code> if not None, else <code>other.filenames_in_collection</code>.</li>
</ul>
</li>
<li>
<p><code>OR(self, other: 'JafResultSet') -&gt; 'JafResultSet'</code> (or <code>self | other</code>)</p>
<ul>
<li>Performs a set union of <code>self.indices</code> and <code>other.indices</code>.</li>
<li>Requires compatibility.</li>
<li>Metadata propagation for <code>collection_id</code> and <code>filenames_in_collection</code> is the same as <code>AND</code>.</li>
</ul>
</li>
<li>
<p><code>NOT(self) -&gt; 'JafResultSet'</code> (or <code>~self</code>)</p>
<ul>
<li>Calculates the complement relative to <code>self.collection_size</code>.</li>
<li><code>new_indices = {0, ..., self.collection_size - 1} - self.indices</code>.</li>
<li>Preserves <code>self.collection_id</code> and <code>self.filenames_in_collection</code>.</li>
</ul>
</li>
<li>
<p><code>XOR(self, other: 'JafResultSet') -&gt; 'JafResultSet'</code> (or <code>self ^ other</code>)</p>
<ul>
<li>Performs a set symmetric difference.</li>
<li>Requires compatibility.</li>
<li>Metadata propagation is the same as <code>AND</code>.</li>
</ul>
</li>
<li>
<p><code>SUBTRACT(self, other: 'JafResultSet') -&gt; 'JafResultSet'</code> (or <code>self - other</code>)</p>
<ul>
<li>Performs set difference (<code>self.indices - other.indices</code>).</li>
<li>Requires compatibility.</li>
<li>Metadata propagation is the same as <code>AND</code>.</li>
</ul>
</li>
</ol>
<p><strong>Compatibility Check (<code>_check_compatibility</code>):</strong>
Before performing binary operations (AND, OR, XOR, SUBTRACT), <code>JafResultSet</code> instances must be compatible:
-   <code>collection_size</code> must be identical.
-   If both <code>collection_id</code>s are not None, they must be identical.
-   If these conditions are not met, a <code>JafResultSetError</code> is raised.
-   Differences in <code>filenames_in_collection</code> between two compatible result sets do not raise an error but may result in the output <code>JafResultSet</code> inheriting this attribute from one of the operands (typically <code>self</code>).</p>
<h2 id="resolving-result-sets-to-original-data">Resolving Result Sets to Original Data<a class="headerlink" href="#resolving-result-sets-to-original-data" title="Permanent link">&para;</a></h2>
<p>The <code>JafResultSet</code> class provides a method to retrieve the original data objects corresponding to its <code>indices</code>.</p>
<p><strong><code>get_matching_objects(self) -&gt; List[Any]</code>:</strong>
-   Attempts to load the original data objects.
-   <strong>Data Source Determination</strong>:
    1.  If <code>self.filenames_in_collection</code> (a list of file paths) is present, these files are loaded in their sorted order to reconstruct the original collection.
    2.  Else, if <code>self.collection_id</code> is a string representing a path to a single existing file, that file is loaded.
    3.  If neither of the above provides a loadable source, a <code>JafResultSetError</code> is raised.
-   <strong>Validation</strong>: After loading, it verifies that the total number of loaded objects matches <code>self.collection_size</code>. If not, a <code>JafResultSetError</code> is raised.
-   <strong>Return</strong>: A list containing the original data objects at the indices specified in <code>self.indices</code>. The objects are returned in the order of the sorted indices.
-   <strong>Errors</strong>: Raises <code>JafResultSetError</code> for issues like unresolvable data sources, file not found, or data inconsistencies.</p>
<h2 id="error-handling">Error Handling<a class="headerlink" href="#error-handling" title="Permanent link">&para;</a></h2>
<h3 id="path-errors">Path Errors<a class="headerlink" href="#path-errors" title="Permanent link">&para;</a></h3>
<ul>
<li>Non-existent specific paths (key not found, index out of bounds for specific index access) result in <code>eval_path</code> returning <code>[]</code> (empty list).</li>
<li>A multi-match path that finds no values results in <code>eval_path</code> returning an empty <code>PathValues</code> object.</li>
<li>A path to a field that exists but has a <code>null</code> value will result in <code>eval_path</code> returning <code>None</code> (if it's a specific path resolving to that <code>null</code>).</li>
<li>Use <code>exists?</code> to check path existence. <code>exists?</code> returns <code>true</code> if <code>eval_path</code> for the given path components returns anything other than an empty list <code>[]</code> (when the path is specific and not found) or an empty <code>PathValues</code> (when the path is multi-match and not found). A path to a <code>null</code> value <em>does</em> exist and <code>exists?</code> will return <code>true</code>.</li>
</ul>
<h3 id="type-errors">Type Errors<a class="headerlink" href="#type-errors" title="Permanent link">&para;</a></h3>
<ul>
<li>Type mismatches within predicate/function evaluations (after <code>PathValues</code> expansion) generally cause that specific evaluation instance to return <code>false</code> (for predicates) or contribute an error marker/skip (for transformers), rather than halting the entire query. The <code>adapt_jaf_operator</code> handles this gracefully.</li>
<li>Invalid query structure or unknown operators raise <code>jafError</code> or <code>ValueError</code>.</li>
</ul>
<h3 id="jafresultset-errors"><code>JafResultSet</code> Errors<a class="headerlink" href="#jafresultset-errors" title="Permanent link">&para;</a></h3>
<ul>
<li>Attempting boolean operations on incompatible <code>JafResultSet</code> instances raises <code>JafResultSetError</code>.</li>
<li>Failure to load or deserialize a <code>JafResultSet</code> (e.g., from JSON) raises <code>ValueError</code> or <code>JafResultSetError</code>.</li>
<li>Failure in <code>get_matching_objects()</code> (e.g., source not found, size mismatch) raises <code>JafResultSetError</code>.</li>
</ul>
<h2 id="example-queries">Example Queries<a class="headerlink" href="#example-queries" title="Permanent link">&para;</a></h2>
<h3 id="basic-filtering">Basic Filtering<a class="headerlink" href="#basic-filtering" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># Find objects where name is &quot;John&quot;</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="p">[</span><span class="s2">&quot;eq?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]]],</span> <span class="s2">&quot;John&quot;</span><span class="p">]</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1"># Find objects with more than 5 items</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="p">[</span><span class="s2">&quot;gt?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">]]]],</span> <span class="mi">5</span><span class="p">]</span>
</span></code></pre></div>
<h3 id="complex-conditions">Complex Conditions<a class="headerlink" href="#complex-conditions" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c1"># Active users with email addresses</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="p">[</span><span class="s2">&quot;and&quot;</span><span class="p">,</span> 
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>  <span class="p">[</span><span class="s2">&quot;eq?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;active&quot;</span><span class="p">]]],</span> <span class="n">true</span><span class="p">],</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>  <span class="p">[</span><span class="s2">&quot;exists?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">]]]]</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="p">]</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="c1"># Case-insensitive language check</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="p">[</span><span class="s2">&quot;eq?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;lower-case&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;language&quot;</span><span class="p">]]]],</span> <span class="s2">&quot;python&quot;</span><span class="p">]</span>
</span></code></pre></div>
<h3 id="path-system-examples">Path System Examples<a class="headerlink" href="#path-system-examples" title="Permanent link">&para;</a></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1"># Any item in &quot;items&quot; list has status &quot;completed&quot;  </span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="p">[</span><span class="s2">&quot;eq?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;wc_level&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">]]],</span> <span class="s2">&quot;completed&quot;</span><span class="p">]</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="c1"># Deep search for any &quot;error&quot; field that exists</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="p">[</span><span class="s2">&quot;exists?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;wc_recursive&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;error&quot;</span><span class="p">]]]]</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="c1"># Get names of users at specific indices 0 and 2</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="c1"># (This path would likely be used with a function that can handle a list of names,</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="c1"># or in a context where multiple names are expected)</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;users&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;indices&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]]]</span> 
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="c1"># Check if any log entry with a key matching &quot;event_.*&quot; has a &quot;level&quot; of &quot;critical&quot;</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="p">[</span><span class="s2">&quot;eq?&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;regex_key&quot;</span><span class="p">,</span> <span class="s2">&quot;event_.*&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;level&quot;</span><span class="p">]]],</span> <span class="s2">&quot;critical&quot;</span><span class="p">]</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="c1"># Check if the first three tags include &quot;urgent&quot;</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="p">[</span><span class="s2">&quot;in?&quot;</span><span class="p">,</span> <span class="s2">&quot;urgent&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;slice&quot;</span><span class="p">,</span> <span class="n">null</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">null</span><span class="p">]]]]</span>
</span></code></pre></div>
<h2 id="design-constraints">Design Constraints<a class="headerlink" href="#design-constraints" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>No Turing Completeness</strong>: No loops, recursion (in query language itself), or unbounded computation.</li>
<li><strong>Filtering Focus</strong>: Designed specifically for boolean filtering operations.</li>
<li><strong>Tagged AST Paths</strong>: Uniform, explicit path component representation.</li>
<li><strong>Predictable Performance</strong>: All operations have bounded execution time relative to data size and path complexity.</li>
<li><strong>Boolean Results for Filtering</strong>: Top-level queries (or conditions in <code>if</code>, <code>and</code>, <code>or</code>) must resolve to boolean values for filtering.</li>
</ol>
<p>This specification defines a minimal, focused JSON filtering language that's powerful enough for real-world use cases while remaining simple and predictable. The path system, with its tagged AST, enhances its explicitness and maintainability. The <code>JafResultSet</code> provides a robust mechanism for working with and combining filter results.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "toc.integrate", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>